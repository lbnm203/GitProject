<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
          rel="stylesheet">
</head>
<style>
    /*body {*/
    /*    font-family: Arial, Helvetica, sans-serif;*/
    /*}*/
    #caro-board {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 20px;
    }

    td {
        width: 24px;
        height: 24px;
        border: 1px solid black;
        text-align: center;
        vertical-align: middle;
        font-size: 20px;
        cursor: pointer;
    }

    td:hover {
        background-color: #f0f0f0;
    }

    button {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px auto;
        cursor: pointer;
        width: 100px;
        height: 50px;
        background-color: #ff0123;
        color: white;
        font-size: 21px;
        font-weight: bold;
        border-radius: 30px;
    }

    button:hover {
        background-color: #007bff;
        color: #ffffff;
    }

    #winner {
        font-size: 25px;
        text-align: center;
        color: #2137d1;
    }
</style>
<body>
<h2 style="text-align: center">CARO BOARD</h2>
<div id="caro-board"></div>
<button onclick="resetGame()">RESET</button>
<h4 id="winner"></h4>
</body>
<script>
    function createEmptyMatrix(rows, cols) {
        let matrix = [];
        for (let i = 0; i < rows; i++) {
            matrix[i] = [];
            for (let j = 0; j < cols; j++) {
                matrix[i][j] = '';
            }
        }
        return matrix;
    }

    function drawMatrix(matrix) {
        let table = "<table border='1' cellspacing='0' cellpadding='10px'>";
        for (let i = 0; i < matrix.length; i++) {
            table += '<tr>';
            for (let j = 0; j < matrix[i].length; j++) {
                table += `<td onclick="handleClick(${i}, ${j})">${matrix[i][j]}</td>`;
            }
            table += '</tr>';
        }
        table += '</table>';
        return document.getElementById('caro-board').innerHTML = table;
    }

    const isWin = (matrix, x, y, currentPlayer) => {
        let directs = [
            [0, 1],
            [1, 0],
            [1, 1],
            [1, -1]
        ]

        for (const [dx, dy] of directs) {
            let count = 1;
            let rows = x + dx;
            let cols = y + dy;

            while (rows >= 0 && rows < matrix.length && cols >= 0 && cols < matrix[0].length && matrix[rows][cols] === currentPlayer) {
                count++;
                rows += dx;
                cols += dy;
            }

            rows = x - dx;
            cols = y - dy;
            while (rows >= 0 && rows < matrix.length && cols >= 0 && cols < matrix[0].length && matrix[rows][cols] === currentPlayer) {
                count++;
                rows -= dx;
                cols -= dy;
            }

            if (count >= 5) {
                return true;
            }
        }
        return false;
    }


    let endGame = false;
    let currentPlayer = 'X';

    function handleClick(x, y) {
        if (endGame || matrix[x][y] !== '') {
            return;
        }

        matrix[x][y] = currentPlayer;
        drawMatrix(matrix);
        if (isWin(matrix, x, y, currentPlayer)) {
            document.getElementById('winner').innerHTML = `Người chơi ${currentPlayer} thắng`;
            document.getElementById('winner').hidden = false;
            endGame = true;
            return;
        }
        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
    }

    function resetGame() {
        matrix = createEmptyMatrix(size, size);
        currentPlayer = 'X';
        drawMatrix(matrix);
        document.getElementById('winner').hidden = true;
        endGame = false;
    }

    let size = 10;
    matrix = createEmptyMatrix(size, size);
    drawMatrix(matrix);
</script>
</html>